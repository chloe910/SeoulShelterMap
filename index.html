<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>ì„œìš¸ì‰¼ğŸ’š</title>
        <link href="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/style.min.css" rel="stylesheet" />
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
        <style>
            body {
                margin: 0;
            }

            #map{
                height: 100vh;
            }
            #mapwrap{position:relative;overflow:hidden;}
            .category, .category *{margin:0;padding:0;color:#000;}   
            .category {position:absolute;overflow:hidden;top:10px;left:10px;width:300px;height:50px;z-index:1000;border:1px solid black;font-family:'Malgun Gothic','ë§‘ì€ ê³ ë”•',sans-serif;font-size:12px;text-align:center;background-color:#fff; display: flex; justify-content: space-around; align-items: center;flex-direction: row;}
            .category .menu_selected {background:#FFDF24;color:#fff;border-left:1px solid #915B2F;border-right:1px solid #915B2F;margin:0; padding: 0;} 
            .category ul {
                padding-left: 0;
                margin: 0;
                display: flex;
                list-style-type: none;
            }
            .category li{list-style:none;width:50px;height:45px;cursor:pointer;display: flex; flex-direction: column;justify-content: center;align-items: center;} 
            .category .ico_comm {display:block;width:32px;height:32px;background:url('image/ì•„ì´ì½˜ëª¨ìŒ.png') no-repeat; background-size: 32px 192px;margin-bottom: 5px;} 
            .category .ico_shade {background-position:0px 0px;}  
            .category .ico_climat {background-position:0px -32px;}   
            .category .ico_heat {background-position:0px -64px;} 
            .category .ico_smart {background-position:0px -96px;} 
            .category .ico_cool {background-position:0px -128px;} 
            .category .ico_cold {background-position:0px -160px;}
            .popup {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: white;
                border: 1px solid black;
                padding: 20px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                z-index: 1000;
            }
        </style>
    </head>
    <body class="sb-nav-fixed">
        <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">
            <!-- Navbar Brand-->
            <a class="navbar-brand ps-3" href="index.html">ì„œìš¸ì‰¼</a>
            <!-- Sidebar Toggle-->
            <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!"><i class="fas fa-bars"></i></button>
            <!-- Navbar Search-->
            <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0">
                <div class="input-group">
                    <input class="form-control" type="text" placeholder="ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" aria-label="Search for address..." aria-describedby="btnNavbarSearch" id="searchInput" />
                    <button class="btn btn-primary" id="btnNavbarSearch" type="button"><i class="fas fa-search"></i></button>
                </div>
            </form>            
        </nav>
        <div id="layoutSidenav">
            <div id="layoutSidenav_nav">
                <nav class="sb-sidenav accordion sb-sidenav-dark" id="sidenavAccordion">
                    <div class="sb-sidenav-menu">
                        <div class="nav">
                            <div class="sb-sidenav-menu-heading">Main</div>
                            <a class="nav-link" href="index.html">
                                <div class="sb-nav-link-icon"><i class="fa-solid fa-map-location-dot"></i></div>
                                ì„œìš¸ì‰¼ ì§€ë„
                            </a>
                            <a class="nav-link" href="total_map.html">
                                <div class="sb-nav-link-icon"><i class="fa-solid fa-map"></i></div>
                                ì„œìš¸ì‰¼ ì „ì²´ ì§€ë„
                            </a>
                            <div class="sb-sidenav-menu-heading">Information</div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseShelterInfo" aria-expanded="false" aria-controls="collapseLayouts">
                                <div class="sb-nav-link-icon"><i class="fa-solid fa-circle-info"></i></div>
                                ì‰¼í„° ì„¤ëª…
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseShelterInfo" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="shadetables.html">ê·¸ëŠ˜ë§‰</a>
                                    <a class="nav-link" href="climattables.html">ê¸°í›„ë™í–‰ì‰¼í„°</a>
                                    <a class="nav-link" href="heattables.html">ë¬´ë”ìœ„ì‰¼í„°</a>
                                    <a class="nav-link" href="smarttables.html">ìŠ¤ë§ˆíŠ¸ì‰¼í„°</a>
                                    <a class="nav-link" href="cooltables.html">ì¿¨í•˜ë‹¤ ìº í˜ì¸</a>
                                    <a class="nav-link" href="coldtables.html">í•œíŒŒì‰¼í„°</a>
                                </nav>
                            </div>
                            <div class="sb-sidenav-menu-heading">Recommend</div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseRecommend" aria-expanded="false" aria-controls="collapsePages">
                                <div class="sb-nav-link-icon"><i class="fa-solid fa-globe"></i></div>
                                ì„œë¹„ìŠ¤ ë³„ ì¶”ì²œ ì‰¼í„°
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseRecommend" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="wifi_index.html">Wi-Fi</a>
                                    <a class="nav-link" href="charge_index.html">ì¶©ì „ì‹œì„¤</a>
                                </nav>
                            </div>
                            <a class="nav-link collapsed" href="#" data-bs-toggle="collapse" data-bs-target="#collapseWeatherRecommend" aria-expanded="false" aria-controls="collapsePages">
                                <div class="sb-nav-link-icon"><i class="fa-solid fa-sun"></i></div>
                                ë‚ ì”¨ ë³„ ì¶”ì²œ ì‰¼í„°
                                <div class="sb-sidenav-collapse-arrow"><i class="fas fa-angle-down"></i></div>
                            </a>
                            <div class="collapse" id="collapseWeatherRecommend" aria-labelledby="headingOne" data-bs-parent="#sidenavAccordion">
                                <nav class="sb-sidenav-menu-nested nav">
                                    <a class="nav-link" href="sumer.html">í­ì—¼/ë¹„</a>
                                    <a class="nav-link" href="winter.html">í•œíŒŒ/ëˆˆ</a>
                                    <a class="nav-link" href="sumer_n_winter.html">í­ì—¼/ë¹„/í•œíŒŒ/ëˆˆ</a>
                                    <a class="nav-link" href="dust.html">ë¯¸ì„¸ë¨¼ì§€</a>
                                </nav>
                            </div>
                        </div>
                    </div>
                    <div class="sb-sidenav-footer">
                        <div class="small">ë„ì‹œ ì† ì‘ì€ ì‰¼í„°</div>
                        ì„œìš¸ì‰¼
                    </div>
                </nav>
            </div>
            <div id="layoutSidenav_content">
                <main>
                    <div id="mapwrap">
                        <div id="map" style="width:100%;height:100vh;"></div>
                        <div class="category">
                        <ul>
                            <li id="shadeMenu" onclick="changeMarker('shade')">
                            <span class="ico_comm ico_shade"></span>
                            ê·¸ëŠ˜ë§‰
                            </li>
                            <li id="climatMenu" onclick="changeMarker('climat')">
                            <span class="ico_comm ico_climat"></span>
                            ê¸°í›„ë™í–‰
                            </li>
                            <li id="heatMenu" onclick="changeMarker('heat')">
                            <span class="ico_comm ico_heat"></span>
                            ë¬´ë”ìœ„
                            </li>
                            <li id="smartMenu" onclick="changeMarker('smart')">
                            <span class="ico_comm ico_smart"></span>
                            ìŠ¤ë§ˆíŠ¸
                            </li>
                            <li id="coolMenu" onclick="changeMarker('cool')">
                            <span class="ico_comm ico_cool"></span>
                            ì¿¨í•˜ë‹¤
                            </li>
                            <li id="coldMenu" onclick="changeMarker('cold')">
                            <span class="ico_comm ico_cold"></span>
                            í•œíŒŒ
                            </li>
                        </ul>
                        </div>
                    </div>
                    <script type="text/javascript"
                        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=5d5e9e2659eb26ee7fdf92c7176b16d6&libraries=services"></script>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>

                    <script>
                        var mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div
                        mapOption = {
                            center: new kakao.maps.LatLng(37.498004414546934, 127.02770621963765), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
                            level: 3 // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
                        };

                        var map = new kakao.maps.Map(mapContainer, mapOption); // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤

                        let shadeMarkers = [];
                        let climatMarkers = [];
                        let heatMarkers = [];
                        let smartMarkers = [];
                        let coolMarkers = [];
                        let coldMarkers = [];

                        // í˜„ì¬ ì—´ë ¤ìˆëŠ” ì¸í¬ìœˆë„ìš°ë¥¼ ì €ì¥í•˜ëŠ” ë³€ìˆ˜
                        let currentInfoWindow = null;

                        const shelterData = [
                            { name : 'ê·¸ëŠ˜ë§‰', ìš´ì˜ì‹œì‘ì¼: '2025-04-21', ìš´ì˜ì¢…ë£Œì¼: '2025-09-01'},
                            { name : 'ê¸°í›„ë™í–‰ì‰¼í„°', ìš´ì˜ì‹œì‘ì¼: '2025-05-01', ìš´ì˜ì¢…ë£Œì¼: '2025-09-30'},
                            { name : 'ë¬´ë”ìœ„ì‰¼í„°', ìš´ì˜ì‹œì‘ì¼: '2025-05-15', ìš´ì˜ì¢…ë£Œì¼: '2025-09-30'},
                            { name : 'ìŠ¤ë§ˆíŠ¸ì‰¼í„°', ìš´ì˜ì‹œì‘ì¼: '2025-01-01', ìš´ì˜ì¢…ë£Œì¼: '2025-12-31'},
                            { name : 'ì¿¨í•˜ë‹¤ ìº í˜ì¸ ë„ì„œê´€', ìš´ì˜ì‹œì‘ì¼: '2024-07-01', ìš´ì˜ì¢…ë£Œì¼: '2024-08-31'},
                            { name : 'í•œíŒŒì‰¼í„°', ìš´ì˜ì‹œì‘ì¼: '2024-11-15', ìš´ì˜ì¢…ë£Œì¼: '2025-03-15'}
                        ];
                        // í˜„ì¬ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
                        const today = new Date();
                        const year = today.getFullYear();
                        const month = String(today.getMonth() + 1).padStart(2, '0'); // ì›”ì€ 0ë¶€í„° ì‹œì‘í•˜ë¯€ë¡œ +1, ë‘ ìë¦¬ ìˆ˜ë¡œ ë§Œë“¤ê¸°
                        const day = String(today.getDate()).padStart(2, '0'); // ì¼ì„ ë‘ ìë¦¬ ìˆ˜ë¡œ ë§Œë“¤ê¸°
                        const currentDate = `${year}-${month}-${day}`;

                        // í˜„ì¬ ë‚ ì§œì— í•´ë‹¹í•˜ëŠ” ì‰¼í„° ì°¾ê¸°
                        const operatingShelters = shelterData.filter(shelter => {
                            return shelter.ìš´ì˜ì‹œì‘ì¼ <= currentDate && shelter.ìš´ì˜ì¢…ë£Œì¼ >= currentDate;
                        });

                        // íŒì—… ë©”ì‹œì§€ ìƒì„±
                        let popupMessage = 'í˜„ì¬ ìš´ì˜ ì¤‘ì¸ ì‰¼í„°: ';
                        if (operatingShelters.length > 0) {
                            const shelterNames = operatingShelters.map(shelter => shelter.name).join(', ');
                            popupMessage += shelterNames;
                        } else {
                            popupMessage += 'ìš´ì˜ ì¤‘ì¸ ì‰¼í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
                        }

                        // íŒì—… ìƒì„± ë° í‘œì‹œ
                        const popupDiv = document.createElement('div');
                        popupDiv.className = 'popup';
                        popupDiv.textContent = popupMessage;
                        document.body.appendChild(popupDiv);

                        // íŒì—…ì„ ìë™ìœ¼ë¡œ ë‹«ëŠ” ê¸°ëŠ¥ ì¶”ê°€
                        setTimeout(() => {
                            popupDiv.remove();
                        }, 3000); // 5ì´ˆ í›„ì— íŒì—… ë‹«ê¸°

                        // JSON íŒŒì¼ì„ ë¡œë“œí•˜ëŠ” í•¨ìˆ˜
                        function loadJsonFiles(files) {
                        const promises = Object.entries(files).map(([category, file]) =>
                            fetch(file)
                            .then((response) => {
                                if (!response.ok) {
                                throw new Error(`HTTP error! status: ${response.status}`);
                                }
                                return response.json();
                            })
                            .then((data) => {
                                console.log(`Loaded ${file}:`, data); // ë°ì´í„° ë¡œë”© í™•ì¸
                                return data.map(item => ({ ...item, category: category }));
                            })
                            .catch((error) => {
                                console.error(`Error loading ${file}:`, error);
                                return [];
                            })
                        );
                        return Promise.all(promises).then(results => results.flat());
                        }

                        // ë§ˆì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
                        function createMarkerImage(src, size, options) {
                        var markerImage = new kakao.maps.MarkerImage(src, size, options);
                        return markerImage;
                        }

                        // ì¢Œí‘œì™€ ë§ˆì»¤ì´ë¯¸ì§€ë¥¼ ë°›ì•„ ë§ˆì»¤ë¥¼ ìƒì„±í•˜ì—¬ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
                        function createMarker(position, image, data) {
                        var marker = new kakao.maps.Marker({
                            position: position,
                            image: image
                        });
                        marker.category = data.category; // ë§ˆì»¤ì— ì¹´í…Œê³ ë¦¬ ì •ë³´ ì €ì¥
                        // ë§ˆì»¤ í´ë¦­ ì‹œ ì¸í¬ìœˆë„ìš°ë¥¼ í‘œì‹œí•˜ëŠ” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
                        kakao.maps.event.addListener(marker, 'click', function() {
                            // í´ë¦­ ì‹œ ë‹¤ë¥¸ ì¸í¬ìœˆë„ìš°ê°€ ì—´ë ¤ìˆìœ¼ë©´ ë‹«ê¸°
                            if (currentInfoWindow) {
                                currentInfoWindow.close();
                            }
                            //ì¸í¬ì¸ë„ìš°ì— í‘œì‹œí•  ë§í¬ ìƒì„±
                            let menuUrl = '';
                            switch (data.category) {
                                case 'shade': menuUrl = '/shadetables.html';break;
                                case 'climat': menuUrl = '/climattables.html?search=' + encodeURIComponent(data['ì‰¼í„°ëª…']);break;
                                case 'heat': menuUrl = '/heattables.html?search=' + encodeURIComponent(data['ì‰¼í„°ëª…']);break;
                                case 'smart': menuUrl = '/smarttables.html?search=' + encodeURIComponent(data['ì‰¼í„°ëª…']);break;
                                case 'cool': menuUrl = '/cooltables.html?search=' + encodeURIComponent(data['ì‰¼í„°ëª…']);break;
                                case 'cold': menuUrl = '/coldtables.html?search=' + encodeURIComponent(data['ì‰¼í„°ëª…']);break;
                            }

                            // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œí•  ë‚´ìš© ìƒì„±
                            var iwContent = '<div style="padding:5px;"><a href="' + menuUrl + '">' + data['ì‰¼í„°ëª…'] + '</a><br>' + '<a href="https://map.kakao.com/link/search/' + encodeURIComponent(data['ì£¼ì†Œ']) + '" style="color:blue" target="_blank">' + data['ì£¼ì†Œ'] + '</a></div>';
                            
                            var iwPosition = position; // ì¸í¬ìœˆë„ìš° í‘œì‹œ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ ìœ„ì¹˜ë¡œ ì„¤ì •
 
                            // ì¸í¬ìœˆë„ìš° ìƒì„±
                            var infowindow = new kakao.maps.InfoWindow({
                                position : iwPosition,
                                content : iwContent
                            });

                            // ì¸í¬ìœˆë„ìš°ë¥¼ ì§€ë„ì— í‘œì‹œ
                            infowindow.open(map, marker);
                            currentInfoWindow = infowindow; // í˜„ì¬ ì—´ë¦° ì¸í¬ìœˆë„ìš°ë¥¼ ì €ì¥
                        });
                        return marker;
                        }

                        function initMap() {
                        const jsonFiles = {
                            shade: 'data/shade.json',
                            climat: 'data/climat.json',
                            heat: 'data/heat.json',
                            smart: 'data/smart.json',
                            cool: 'data/cool.json',
                            cold: 'data/cold.json'
                        };

                        // ì¹´í…Œê³ ë¦¬ë³„ ì´ë¯¸ì§€ íŒŒì¼ ê²½ë¡œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
                        const markerImageUrls = {
                            shade: 'image/ê·¸ëŠ˜ë§‰.png',
                            climat: 'image/ê¸°í›„ë™í–‰ì‰¼í„°.png',
                            heat: 'image/ë¬´ë”ìœ„ì‰¼í„°.png',
                            smart: 'image/ìŠ¤ë§ˆíŠ¸ì‰¼í„°.png',
                            cool: 'image/ì¿¨í•˜ë‹¤ìº í˜ì¸.png',
                            cold: 'image/í•œíŒŒì‰¼í„°.png',
                        };

                        loadJsonFiles(jsonFiles)
                            .then((data) => {
                            data.forEach(item => {
                                let markerPosition = new kakao.maps.LatLng(item['decimalLatitude'], item['decimalLongitude']);
                                let markerImage = null;

                                var imageSize = new kakao.maps.Size(32, 32);
                                var imageOptions = {
                                anchor: new kakao.maps.Point(16, 16)
                                };

                                // ì¹´í…Œê³ ë¦¬ì— ë”°ë¼ ë§ˆì»¤ ì´ë¯¸ì§€ ì„¤ì •
                                const imageUrl = markerImageUrls[item.category];
                                if (imageUrl) {
                                markerImage = createMarkerImage(imageUrl, imageSize, imageOptions);
                                }

                                let marker = createMarker(markerPosition, markerImage, item);

                                // ì¹´í…Œê³ ë¦¬ë³„ ë§ˆì»¤ ë°°ì—´ì— ì¶”ê°€
                                switch (item.category) {
                                case 'shade': shadeMarkers.push(marker); break;
                                case 'climat': climatMarkers.push(marker); break;
                                case 'heat': heatMarkers.push(marker); break;
                                case 'smart': smartMarkers.push(marker); break;
                                case 'cool': coolMarkers.push(marker); break;
                                case 'cold': coldMarkers.push(marker); break;
                                }
                            });

                            console.log('shadeMarkers:', shadeMarkers);
                            console.log('climatMarkers:', climatMarkers);
                            console.log('heatMarkers:', heatMarkers);
                            console.log('smartMarkers:', smartMarkers);
                            console.log('coolMarkers:', coolMarkers);
                            console.log('coldMarkers:', coldMarkers);

                            changeMarker('shade');
                            })
                            .catch(error => console.error('Error initializing map:', error));
                        }

                        document.addEventListener('DOMContentLoaded', initMap);

                        // ì¹´í…Œê³ ë¦¬ë¥¼ í´ë¦­í–ˆì„ ë•Œ typeì— ë”°ë¼ ì¹´í…Œê³ ë¦¬ì˜ ìŠ¤íƒ€ì¼ê³¼ ì§€ë„ì— í‘œì‹œë˜ëŠ” ë§ˆì»¤ë¥¼ ë³€ê²½í•©ë‹ˆë‹¤
                        function changeMarker(type) {

                        var shadeMenu = document.getElementById('shadeMenu');
                        var climatMenu = document.getElementById('climatMenu');
                        var heatMenu = document.getElementById('heatMenu');
                        var smartMenu = document.getElementById('smartMenu');
                        var coolMenu = document.getElementById('coolMenu');
                        var coldMenu = document.getElementById('coldMenu');

                        // ì¹´í…Œê³ ë¦¬ ìŠ¤íƒ€ì¼ ë³€ê²½
                        shadeMenu.className = type === 'shade' ? 'menu_selected' : '';
                        climatMenu.className = type === 'climat' ? 'menu_selected' : '';
                        heatMenu.className = type === 'heat' ? 'menu_selected' : '';
                        smartMenu.className = type === 'smart' ? 'menu_selected' : '';
                        coolMenu.className = type === 'cool' ? 'menu_selected' : '';
                        coldMenu.className = type === 'cold' ? 'menu_selected' : '';

                        // ëª¨ë“  ë§ˆì»¤ ìˆ¨ê¹€
                        hideAllMarkers();

                        // ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì˜ ë§ˆì»¤ë§Œ í‘œì‹œ
                        let selectedMarkers = [];
                        switch (type) {
                            case 'shade':
                            selectedMarkers = shadeMarkers;
                            break;
                            case 'climat':
                            selectedMarkers = climatMarkers;
                            break;
                            case 'heat':
                            selectedMarkers = heatMarkers;
                            break;
                            case 'smart':
                            selectedMarkers = smartMarkers;
                            break;
                            case 'cool':
                            selectedMarkers = coolMarkers;
                            break;
                            case 'cold':
                            selectedMarkers = coldMarkers;
                            break;
                        }
                        showMarkers(selectedMarkers);
                        }

                        // ëª¨ë“  ë§ˆì»¤ë¥¼ ìˆ¨ê¸°ëŠ” í•¨ìˆ˜
                        function hideAllMarkers() {
                        shadeMarkers.forEach((marker) => marker.setMap(null));
                        climatMarkers.forEach((marker) => marker.setMap(null));
                        heatMarkers.forEach((marker) => marker.setMap(null));
                        smartMarkers.forEach((marker) => marker.setMap(null));
                        coolMarkers.forEach((marker) => marker.setMap(null));
                        coldMarkers.forEach((marker) => marker.setMap(null));
                        }

                        // íŠ¹ì • ë§ˆì»¤ ë°°ì—´ì„ ì§€ë„ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
                        function showMarkers(markers) {
                            console.log('showMarkers called with:', markers);
                            if (markers && markers.length > 0) {
                                markers.forEach(marker => {
                                console.log('Setting marker to map:', marker);
                                marker.setMap(map);
                                });
                            } else {
                                console.log('showMarkers: No markers to show or empty array');
                            }
                        }

                        // ì´ìš©ì ìœ„ì¹˜ í‘œì‹œ
                        if (navigator.geolocation) {
                            // GeoLocationì„ ì´ìš©í•´ì„œ ì ‘ì† ìœ„ì¹˜ë¥¼ ì–»ì–´ì˜µë‹ˆë‹¤
                            navigator.geolocation.getCurrentPosition(function(position) {
                                var lat = position.coords.latitude; // ìœ„ë„
                                var lon = position.coords.longitude; // ê²½ë„

                                var locPosition = new kakao.maps.LatLng(lat, lon); // ë§ˆì»¤ê°€ í‘œì‹œë  ìœ„ì¹˜ë¥¼ geolocationìœ¼ë¡œ ì–»ì–´ì˜¨ ì¢Œí‘œë¡œ ìƒì„±í•©ë‹ˆë‹¤
                                var message = '<div style="padding:5px;">í˜„ìœ„ì¹˜</div>'; // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œë  ë‚´ìš©ì…ë‹ˆë‹¤

                                // ì´ìš©ì ìœ„ì¹˜ ë§ˆì»¤ ìƒì„± ë° í‘œì‹œ (zIndex ë†’ê²Œ ì„¤ì •)
                                var userMarker = new kakao.maps.Marker({
                                    position: locPosition,
                                    zIndex: 10 // ë‹¤ë¥¸ ë§ˆì»¤(ê¸°ë³¸ zIndex 0)ë³´ë‹¤ ë†’ê²Œ ì„¤ì •
                                });
                                userMarker.setMap(map);

                                // ì´ìš©ì ìœ„ì¹˜ ì¸í¬ìœˆë„ìš° ìƒì„± ë° í‘œì‹œ (zIndex ë” ë†’ê²Œ ì„¤ì •)
                                var infowindow = new kakao.maps.InfoWindow({
                                    position: locPosition,
                                    content: message,
                                    zIndex: 11 // ë§ˆì»¤ë³´ë‹¤ ë” ë†’ê²Œ ì„¤ì •í•˜ì—¬ í™•ì‹¤íˆ ì•ì— ë³´ì´ë„ë¡ í•¨
                                });
                                infowindow.open(map, userMarker);

                            }, function(error) { // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ ìœ„ì¹˜ì— í‘œì‹œ
                                var locPosition = new kakao.maps.LatLng(37.566826, 126.9786567); // ê¸°ë³¸ ìœ„ì¹˜ (ì„œìš¸)
                                var message = 'geolocationì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš”..';

                                var userMarker = new kakao.maps.Marker({
                                    position: locPosition,
                                    zIndex: 10
                                });
                                userMarker.setMap(map);

                                var infowindow = new kakao.maps.InfoWindow({
                                    position: locPosition,
                                    content: message,
                                    zIndex: 11
                                });
                                infowindow.open(map, userMarker);
                            });
                        } else { // HTML5ì˜ GeoLocationì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ë•Œ ë§ˆì»¤ í‘œì‹œ ìœ„ì¹˜ì™€ ì¸í¬ìœˆë„ìš° ë‚´ìš©ì„ ì„¤ì •í•©ë‹ˆë‹¤
                            var locPosition = new kakao.maps.LatLng(37.566826, 126.9786567); // ê¸°ë³¸ ìœ„ì¹˜ (ì„œìš¸)
                            var message = 'geolocationì„ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ìš”..';

                            var userMarker = new kakao.maps.Marker({
                                position: locPosition,
                                zIndex: 10
                            });
                            userMarker.setMap(map);

                            var infowindow = new kakao.maps.InfoWindow({
                                position: locPosition,
                                content: message,
                                zIndex: 11
                            });
                            infowindow.open(map, userMarker);
                        }

                        // ì§€ë„ì— ë§ˆì»¤ì™€ ì¸í¬ìœˆë„ìš°ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
                        function displayMarker(locPosition, message) {

                        // ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                        var marker = new kakao.maps.Marker({
                            map: map,
                            position: locPosition
                        });

                        var iwContent = message, // ì¸í¬ìœˆë„ìš°ì— í‘œì‹œí•  ë‚´ìš©
                            iwRemoveable = true;

                        // ì¸í¬ìœˆë„ìš°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
                        var infowindow = new kakao.maps.InfoWindow({
                            content: iwContent,
                            removable: iwRemoveable
                        });

                        // ì¸í¬ìœˆë„ìš°ë¥¼ ë§ˆì»¤ìœ„ì— í‘œì‹œí•©ë‹ˆë‹¤
                        infowindow.open(map, marker);

                        // ì§€ë„ ì¤‘ì‹¬ì¢Œí‘œë¥¼ ì ‘ì†ìœ„ì¹˜ë¡œ ë³€ê²½í•©ë‹ˆë‹¤
                        map.setCenter(locPosition);
                        }
                        //ê²€ìƒ‰ ì£¼ì†Œ í‘œì‹œ ì½”ë“œ
                        var geocoder = new kakao.maps.services.Geocoder();
                        let currentMarker = null; 
                        const searchInput = document.getElementById('searchInput'); // HTMLì— ì¶”ê°€í•œ input ID
                        const searchButton = document.getElementById('btnNavbarSearch'); // ê²€ìƒ‰ ë²„íŠ¼ ID
                        searchButton.addEventListener('click', function() {
                            performSearch();
                        });

                        // input í•„ë“œì—ì„œ Enter í‚¤ë¥¼ ëˆŒë €ì„ ë•Œë„ ê²€ìƒ‰ì„ ìˆ˜í–‰í•˜ë„ë¡ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
                        searchInput.addEventListener('keypress', function(event) {
                            // Enter í‚¤ ì½”ë“œ(13) ë˜ëŠ” 'Enter' í‚¤ ì´ë¦„ì„ í™•ì¸í•©ë‹ˆë‹¤.
                            if (event.key === 'Enter') {
                                event.preventDefault();
                                performSearch();
                            }
                        });

                        // 4. ì£¼ì†Œ ê²€ìƒ‰ ë° ê²°ê³¼ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
                        function performSearch() {
                            const address = searchInput.value; // input í•„ë“œì˜ í˜„ì¬ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.

                            // ì…ë ¥ ê°’ì´ ë¹„ì–´ìˆëŠ”ì§€ í™•ì¸
                            if (!address) {
                                alert('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                                return; // í•¨ìˆ˜ ì‹¤í–‰ ì¤‘ë‹¨
                            }

                            // Kakao Maps Geocoderë¥¼ ì‚¬ìš©í•˜ì—¬ ì£¼ì†Œë¡œ ì¢Œí‘œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.
                            geocoder.addressSearch(address, function(result, status) {
                                // ì •ìƒì ìœ¼ë¡œ ê²€ìƒ‰ì´ ì™„ë£Œëìœ¼ë©´
                                if (status === kakao.maps.services.Status.OK) {

                                    var coords = new kakao.maps.LatLng(result[0].y, result[0].x);

                                    // (ê¸°ì¡´ ë§ˆì»¤ê°€ ìˆë‹¤ë©´ ì œê±°í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€
                                    if (currentMarker) {
                                        currentMarker.setMap(null);
                                    }

                                    // ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¥¼ ë§ˆì»¤ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.
                                    var marker = new kakao.maps.Marker({
                                        map: map, // ì „ì—­ ë³€ìˆ˜ 'map' ì‚¬ìš©
                                        position: coords
                                    });
                                    currentMarker = marker; // ë§ˆì»¤ ê°ì²´ ì €ì¥

                                    // ì¸í¬ìœˆë„ìš°ë¡œ ì¥ì†Œì— ëŒ€í•œ ì„¤ëª…ì„ í‘œì‹œí•©ë‹ˆë‹¤.
                                    var infowindow = new kakao.maps.InfoWindow({
                                        content: '<div style="width:150px;text-align:center;padding:6px 0;">ê²€ìƒ‰í•œ ìœ„ì¹˜</div>'
                                    });
                                    infowindow.open(map, marker);

                                    // ì§€ë„ì˜ ì¤‘ì‹¬ì„ ê²°ê³¼ê°’ìœ¼ë¡œ ë°›ì€ ìœ„ì¹˜ë¡œ ì´ë™ì‹œí‚µë‹ˆë‹¤.
                                    map.setCenter(coords);

                                } else {
                                    // ì£¼ì†Œ ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
                                    alert('ì£¼ì†Œ ê²€ìƒ‰ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”: ' + status);
                                    // ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ ë§ˆì»¤ë‚˜ ì¸í¬ìœˆë„ìš°ë¥¼ ì œê±°í•˜ë ¤ë©´ ìœ„ì˜ ì£¼ì„ ì²˜ë¦¬ëœ ì½”ë“œë¥¼ í™œìš©í•˜ì„¸ìš”.
                                }
                            });
                        }
                    </script>
                </main>
                <footer class="py-4 bg-light mt-auto">
                    <div class="container-fluid px-4">
                        <div class="d-flex align-items-center justify-content-between small">
                            <div class="text-muted">Copyright &copy; Your Website 2023</div>
                            <div>
                                <a href="#">Privacy Policy</a>
                                &middot;
                                <a href="#">Terms &amp; Conditions</a>
                            </div>
                        </div>
                    </div>
                </footer>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="js/scripts.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js" crossorigin="anonymous"></script>
        <script src="assets/demo/chart-area-demo.js"></script>
        <script src="assets/demo/chart-bar-demo.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/simple-datatables@7.1.2/dist/umd/simple-datatables.min.js" crossorigin="anonymous"></script>
        <script src="js/datatables-simple-demo.js"></script>
    </body>
</html>
